(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{122:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return s}));var a=n(2),o=n(6),r=(n(0),n(132)),i={id:"restapi",title:"Java Micronaut REST API"},l={id:"micronaut/restapi",isDocsHomePage:!1,title:"Java Micronaut REST API",description:"Time: 45 minutes",source:"@site/docs\\micronaut\\rest_api.md",permalink:"/code_now/docs/micronaut/restapi",editUrl:"https://github.com/VitSestak/code_now/docs/micronaut/rest_api.md",sidebar:"Docs",previous:{title:"Java Micronaut REST Server with PostgreSQL",permalink:"/code_now/docs/micronaut/postgre"},next:{title:"Administration manuals",permalink:"/code_now/docs/admin_manuals/admMan"}},c=[{value:"What you\u2019ll learn",id:"what-youll-learn",children:[]},{value:"Project source",id:"project-source",children:[]},{value:"Prerequisites",id:"prerequisites",children:[]},{value:"Steps",id:"steps",children:[]},{value:"What\u2019s next?",id:"whats-next",children:[]}],p={rightToc:c};function s(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Time: 45 minutes"),Object(r.b)("h2",{id:"what-youll-learn"},"What you\u2019ll learn"),Object(r.b)("p",null,"How to setup your application for : "),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"getting data from REST API, "),Object(r.b)("li",{parentName:"ul"},"providing data to REST API.")),Object(r.b)("p",null,"In this tutorial, we will create a simple Java component with the Java Micronaut scaffolder. We want to expose the single REST endpoint for getting user details for his username only. This will require simple sequential orchestration of two REST services, one to get user authorization privileges and second for basic user details. "),Object(r.b)("p",null,Object(r.b)("img",Object(a.a)({parentName:"p"},{src:"addr",alt:"pic"}))),Object(r.b)("h2",{id:"project-source"},"Project source"),Object(r.b)("p",null,"This example project can be cloned from: ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"mailto:git@gitlab.factory.innobank.codenow.com"}),"git@gitlab.factory.innobank.codenow.com"),":innobank/client-info-service.git"),Object(r.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Prepare your local development environment for CodeNOW with Micronaut. ",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Follow the tutorial instructions in the ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"https://www.codenow.com/docs/local-development-with-codenow/java-micronaut-local-development/"}),"Java Micronaut Local Development")," tutorial."))),Object(r.b)("li",{parentName:"ul"},"Create a new component",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"For details, see the section ",Object(r.b)("em",{parentName:"li"},"Prerequisites")," of the ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"https://www.codenow.com/docs/local-development-with-codenow/java-micronaut-local-development/"}),"Java Micronaut Local Development")," tutorial.")))),Object(r.b)("h2",{id:"steps"},"Steps"),Object(r.b)("p",null,"Open your IDE, import the created component and start coding:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Define the message payload. Here is an example of the GetClientInfoResponse, which is a simple POJO with basic user details and roles:"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Generate getters and setters with your IDE.")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Examples of GetClientDataResponse and GetClientRolesResponse can be found in the example project repository."),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"01  package io.codenow.client.info.service.model;\n02   \n03  import java.time.LocalDate;\n04  import java.util.Set;\n05   \n06  public class GetClientInfoResponse {\n07 \n08      private String firstname;\n09      private String surname;\n10      private LocalDate birthdate;\n11      private Set<String> roles;\n12  }\n"))))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Next, create http clients for calling the orchestrated endpoints. Example for ClientDataServiceClient:"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"The second required client ClientAuthorizationServiceClient can be found in the example project repository")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"For more details about Micronaut clients: ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.micronaut.io/latest/guide/httpClient.html#clientAnnotation"}),"https://docs.micronaut.io/latest/guide/http<Client.html#clientAnnotation"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Create a new Java interface:"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'01  package io.codenow.client.info.service.clients;\n02 \n03  import io.codenow.client.info.service.model.GetClientDataResponse;\n04  import io.micronaut.http.annotation.Get;\n05  import io.micronaut.http.annotation.PathVariable;\n06  import io.micronaut.http.client.annotation.Client;\n07  import io.reactivex.Single;\n08 \n09  @Client("http://client-data-service")\n10  public interface ClientDataServiceClient {\n11 \n12      @Get("/data/{username}")\n13      public Single<GetClientDataResponse> getClientData(@PathVariable String username);\n14  }\n'))))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Create a new controller and put all the parts together"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"For more details, see ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.micronaut.io/latest/guide/index.html#httpServer"}),"https://docs.micronaut.io/latest/guide/index.html#httpServer")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'01  package io.codenow.client.info.service.controller;\n02 \n03 \n04  import java.util.Set;\n05 \n06  import org.slf4j.Logger;\n07  import org.slf4j.LoggerFactory;\n08 \n09  import io.codenow.client.info.service.clients.ClientAuthorizationServiceClient;\n10  import io.codenow.client.info.service.clients.ClientDataServiceClient;\n11  import io.codenow.client.info.service.model.GetClientDataResponse;\n12  import io.codenow.client.info.service.model.GetClientInfoResponse;\n13  import io.codenow.client.info.service.model.GetClientRolesResponse;\n14  import io.micronaut.http.annotation.Consumes;\n15  import io.micronaut.http.annotation.Controller;\n16  import io.micronaut.http.annotation.Get;\n17  import io.micronaut.http.annotation.PathVariable;\n18  import io.micronaut.http.annotation.Produces;\n19  import io.micronaut.validation.Validated;\n20  import io.reactivex.Single;\n21   \n22 \n23  @Validated\n24  @Controller("/info")\n25  public class ClientInfoController {\n26 \n27      private static final Logger LOG = LoggerFactory.getLogger(ClientInfoController.class);\n28     \n29      private ClientAuthorizationServiceClient clientAuthorizationServiceClient;\n30      private ClientDataServiceClient clientDataServiceClient;\n31     \n32      public ClientInfoController(ClientAuthorizationServiceClient clientAuthorizationServiceClient,\n33           ClientDataServiceClient clientDataServiceClient) {\n34       super();\n35       this.clientAuthorizationServiceClient = clientAuthorizationServiceClient;\n36       this.clientDataServiceClient = clientDataServiceClient;\n37      }\n38 \n39      @Get("/{username}")\n40      @Produces\n41      @Consumes\n42      public Single<GetClientInfoResponse> getClientInfo(@PathVariable String username) {\n43       LOG.info("username: {}", username);\n44 \n45       Single<GetClientRolesResponse> rolesResp = clientAuthorizationServiceClient.getClientRoles(username);\n46       Single<GetClientDataResponse> clientDataResp = clientDataServiceClient.getClientData(username);\n47      \n48       Set<String> roles = rolesResp.blockingGet().getRoles();\n49       GetClientInfoResponse response = new GetClientInfoResponse();\n50       response.setRoles(roles);\n51       GetClientDataResponse info = clientDataResp.blockingGet();\n52       response.setBirthdate(info.getBirthdate());\n53       response.setFirstname(info.getFirstname());\n54       response.setSurname(info.getSurname());\n55 \n56          return Single.just(response);\n57      }\n58  }\n'))))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Do not forget to change the swagger.yaml. Check it in the example project: ",Object(r.b)("em",{parentName:"p"},"src/main/resources/META-INF/swagger/swagger.yaml"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Try to build and run the application in your IDE. After startup, you should be able to access your new controller\u2019s swagger: ",Object(r.b)("strong",{parentName:"p"},Object(r.b)("a",Object(a.a)({parentName:"strong"},{href:"http://localhost:8080/swagger/index.html"}),"http://localhost:8080/swagger/index.html"))),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"For the correct setup, check the Readme.md in the project root or see the tutorial ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"https://www.codenow.com/docs/local-development-with-codenow/java-micronaut-local-development/"}),"Java Micronaut Local Development"),", section ",Object(r.b)("em",{parentName:"li"},"Prepare local development IDE")),Object(r.b)("li",{parentName:"ul"},"The component exposes a simple GET endpoint and can be tested using a browser call only. You should not forget to document your API and use the swagger-ui accordingly.")))),Object(r.b)("p",null,Object(r.b)("img",Object(a.a)({parentName:"p"},{src:"add",alt:"pi"}))),Object(r.b)("h2",{id:"whats-next"},"What\u2019s next?"),Object(r.b)("p",null,"If your code works in the local development, you are ready to push your changes to GIT and try to build and deploy your new component version to the CodeNOW environment. For more information, see ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.codenow.com/docs/administration-manuals/deploy-application/"}),"Application Deployment")," and ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.codenow.com/docs/administration-manuals/deployment-monitoring/"}),"Monitoring"),"."),Object(r.b)("p",null,"See our other developer guides to get orchestrated microservices ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.codenow.com/docs/java-micronaut-examples/java-micronaut-rest-server-with-postgresql/"}),"Micronaut REST Server with PostgreSQL")," and ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.codenow.com/docs/java-micronaut-examples/java-micronaut-rest-server-with-redis-and-kafka/"}),"Micronaut REST Server with Redis and Kafka")," working."))}s.isMDXComponent=!0},132:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return d}));var a=n(0),o=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=o.a.createContext({}),s=function(e){var t=o.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=s(e.components);return o.a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},b=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,i=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),m=s(n),b=a,d=m["".concat(i,".").concat(b)]||m[b]||u[b]||r;return n?o.a.createElement(d,l(l({ref:t},p),{},{components:n})):o.a.createElement(d,l({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=b;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var p=2;p<r;p++)i[p]=n[p];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);